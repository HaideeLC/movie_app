<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>é›»å½±è¨‚ç¥¨ç³»çµ±</title>
<style>
/* ===== èƒŒæ™¯æµ·å ±ç‰† (æ¨¡ç³Š) ===== */
body {
    margin: 0;
    font-family: "Segoe UI", Arial, sans-serif;
    min-height: 100vh;
    background: url('https://images.unsplash.com/photo-1524985069026-dd778a71c7b4?auto=format&fit=crop&w=1470&q=80') no-repeat center center fixed;
    background-size: cover;
}

body::before {
    content: "";
    position: fixed;
    inset: 0;
    background: inherit;
    filter: blur(12px);
    z-index: -1;
}

/* ===== ä¸»è¦å®¹å™¨ ===== */
.main-container {
    position: relative;
    z-index: 1;
    max-width: 1200px;
    margin: 30px auto;
    padding: 0 20px;
}

/* ===== å°è¦½åˆ— ===== */
.navbar {
    position: relative;
    z-index: 2;
    background-color: rgba(31, 41, 55, 0.8);
    color: white;
    padding: 12px 24px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-radius: 8px;
}

.navbar a {
    color: #e5e7eb;
    margin-left: 15px;
    text-decoration: none;
}

.navbar a:hover {
    color: white;
    text-decoration: underline;
}

/* ===== é›»å½±å¡ç‰‡ç¶²æ ¼ ===== */
.movie-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

/* ===== å¡ç‰‡æ¨£å¼ ===== */
.movie-card {
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(6px);
    border-radius: 15px;
    overflow: hidden;
    box-shadow: 0 8px 20px rgba(0,0,0,0.3);
    transition: transform 0.3s, box-shadow 0.3s;
    cursor: pointer;
}

.movie-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 30px rgba(0,0,0,0.4);
}

/* ===== æµ·å ± ===== */
.movie-card img {
    width: 100%;
    height: 320px;
    object-fit: cover;
    transition: transform 0.3s;
}

.movie-card:hover img {
    transform: scale(1.05);
}

/* ===== æ–‡å­—å€å¡Š ===== */
.movie-content {
    padding: 12px;
    text-align: center;
    color: white;
}

.movie-title {
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 6px;
}

.movie-info {
    font-size: 14px;
    opacity: 0.85;
    margin-bottom: 4px;
}

/* ===== æŒ‰éˆ• ===== */
button {
    border: none;
    border-radius: 6px;
    padding: 6px 12px;
    color: white;
    cursor: pointer;
    margin: 3px;
}

.book-btn { background-color: #16a34a; }
.book-btn[disabled] { background-color: gray; cursor: not-allowed; }
.delete-btn { background-color: #dc2626; }
.add-btn { background-color: #2563eb; }

.disabled {
    color: lightgray;
    font-size: 14px;
}

form.inline {
    display: inline;
}
</style>
</head>
<body>

<div class="main-container">

    <!-- å°è¦½åˆ— -->
    <div class="navbar">
        <div>ğŸ¬ é›»å½±è¨‚ç¥¨ç³»çµ±</div>
        <div>
            {% if session.full_name %}
                ä½ å¥½ï¼Œ{{ session.full_name }}
                <a href="/order">ğŸ“„ è¨‚å–®</a>
                <a href="/logout">ç™»å‡º</a>
            {% else %}
                <a href="/login">ç™»å…¥</a>
                <a href="/register">è¨»å†Š</a>
                <a href="/order">ğŸ“„ æŸ¥è©¢è¨‚å–®</a>
                <a href="/employee_login">å“¡å·¥ç™»å…¥</a>
            {% endif %}
        </div>
    </div>

    <!-- å“¡å·¥æ–°å¢é›»å½± -->
    {% if session.employee_id %}
    <div style="margin-top:20px; background: rgba(255,255,255,0.15); padding: 15px; border-radius:12px; backdrop-filter:blur(6px);">
        <h3 style="color:white;">æ–°å¢é›»å½±ï¼ˆå“¡å·¥ï¼‰</h3>
        <form method="post" action="/manage_movies">
            <input type="text" name="title" placeholder="é›»å½±åç¨±" required>
            <input type="text" name="showtime" placeholder="æ”¾æ˜ æ™‚é–“" required>
            <input type="text" name="poster_url" placeholder="static/posters/xxx.jpg">
            <button type="submit" class="add-btn">æ–°å¢</button>
        </form>
    </div>
    {% endif %}

    <!-- é›»å½±å¡ç‰‡ç‰† -->
    <div class="movie-grid">
        {% for movie in movies %}
        <div class="movie-card">

            <!-- å¯é»æ“Šé€²å…¥è¨‚ç¥¨ -->
            {% if session.username and movie.remaining_seats > 0 %}
                <a href="/book/{{ movie.id }}">
                    {% if movie.poster_url %}
                        <img src="{{ url_for('static', filename=movie.poster_url) }}">
                    {% else %}
                        <img src="https://via.placeholder.com/300x400?text=No+Image">
                    {% endif %}
                </a>
            {% else %}
                {% if movie.poster_url %}
                    <img src="{{ url_for('static', filename=movie.poster_url) }}">
                {% else %}
                    <img src="https://via.placeholder.com/300x400?text=No+Image">
                {% endif %}
            {% endif %}

            <!-- æ–‡å­—å€å¡Šåœ¨åœ–ç‰‡ä¸‹æ–¹ -->
            <div class="movie-content">
                <div class="movie-title">{{ movie.title }}</div>
                <div class="movie-info">ğŸ•’ {{ movie.showtime }}</div>
                <div class="movie-info">ğŸŸ å‰©é¤˜ {{ movie.remaining_seats }} ä½</div>

                {% if session.username %}
                    {% if movie.remaining_seats > 0 %}
                        <form method="get" action="/book/{{ movie.id }}" class="inline">
                            <button class="book-btn">è¨‚ç¥¨</button>
                        </form>
                    {% else %}
                        <button class="book-btn" disabled>å·²å”®å®Œ</button>
                    {% endif %}
                {% else %}
                    <div class="disabled">è«‹å…ˆç™»å…¥</div>
                {% endif %}

                {% if session.employee_id %}
                    <form method="post" action="/delete_movie/{{ movie.id }}" class="inline"
                          onsubmit="return confirm('ç¢ºå®šåˆªé™¤é€™éƒ¨é›»å½±å—ï¼Ÿ');">
                        <button class="delete-btn">åˆªé™¤</button>
                    </form>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>

</div>

</body>
</html>