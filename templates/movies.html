<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>é›»å½±åˆ—è¡¨</title>

    <style>
        body {
            margin: 0;
            font-family: "Segoe UI", Arial, sans-serif;
            background-color: #f4f6f8;
        }

        /* ===== å°è¦½åˆ— ===== */
        .navbar {
            background-color: #1f2937;
            color: white;
            padding: 12px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .navbar a {
            color: #e5e7eb;
            margin-left: 15px;
            text-decoration: none;
        }

        .navbar a:hover {
            color: white;
            text-decoration: underline;
        }

        /* ===== ä¸»å…§å®¹ ===== */
        .container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }

        h1 {
            margin-bottom: 20px;
        }

        /* ===== æ–°å¢é›»å½±ï¼ˆå“¡å·¥ï¼‰ ===== */
        .add-movie {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }

        .add-movie input {
            margin-right: 10px;
            padding: 6px;
        }

        /* ===== é›»å½±å¡ç‰‡ ===== */
        .movie-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 20px;
        }

        .movie-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }

        .movie-card:hover {
            transform: translateY(-5px);
        }

        .movie-card img {
            width: 100%;
            height: 320px;
            object-fit: cover;
        }

        .movie-card a img {
            cursor: pointer;
        }

        .movie-card a img:hover {
            opacity: 0.9;
        }

        .movie-content {
            padding: 15px;
            text-align: center;
        }

        .movie-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .movie-info {
            font-size: 14px;
            color: #555;
            margin-bottom: 6px;
        }

        /* ===== æŒ‰éˆ• ===== */
        button {
            border: none;
            border-radius: 6px;
            padding: 6px 12px;
            color: white;
            cursor: pointer;
            margin: 3px;
        }

        .book-btn { background-color: #16a34a; }
        .book-btn[disabled] { background-color: gray; cursor: not-allowed; }
        .delete-btn { background-color: #dc2626; }
        .add-btn { background-color: #2563eb; }

        .disabled {
            color: gray;
            font-size: 14px;
        }

        form.inline {
            display: inline;
        }
    </style>
</head>

<body>

<!-- ===== å°è¦½åˆ— ===== -->
<div class="navbar">
    <div>ğŸ¬ é›»å½±è¨‚ç¥¨ç³»çµ±</div>
    <div>
        {% if session.username %}
            ä½ å¥½ï¼Œ{{ session.username }}
            <a href="/order">ğŸ“„ è¨‚å–®</a>
            <a href="/logout">ç™»å‡º</a>
        {% else %}
            <a href="/login">ç™»å…¥</a>
            <a href="/register">è¨»å†Š</a>
            <a href="/order">ğŸ“„ æŸ¥è©¢è¨‚å–®</a>
            <a href="/employee_login">å“¡å·¥ç™»å…¥</a>
        {% endif %}
    </div>
</div>

<div class="container">
    <h1>é›»å½±åˆ—è¡¨</h1>

    {% if session.employee_id %}
    <div class="add-movie">
        <h3>æ–°å¢é›»å½±ï¼ˆå“¡å·¥ï¼‰</h3>
        <form method="post" action="/manage_movies">
            <input type="text" name="title" placeholder="é›»å½±åç¨±" required>
            <input type="text" name="showtime" placeholder="æ”¾æ˜ æ™‚é–“" required>
            <input type="text" name="poster_url" placeholder="static/posters/xxx.jpg">
            <button type="submit" class="add-btn">æ–°å¢</button>
        </form>
    </div>
    {% endif %}

    <div class="movie-grid">
        {% for movie in movies %}
        <div class="movie-card">

            <!-- ğŸ¬ é›»å½±åœ–ç‰‡ï¼ˆå¯é»æ“Šé€²å…¥è¨‚ç¥¨ï¼‰ -->
            {% if session.username and movie.remaining_seats > 0 %}
                <a href="/book/{{ movie.id }}">
                    {% if movie.poster_url %}
                        <img src="{{ url_for('static', filename=movie.poster_url) }}">
                    {% else %}
                        <img src="https://via.placeholder.com/300x400?text=No+Image">
                    {% endif %}
                </a>
            {% else %}
                {% if movie.poster_url %}
                    <img src="{{ url_for('static', filename=movie.poster_url) }}">
                {% else %}
                    <img src="https://via.placeholder.com/300x400?text=No+Image">
                {% endif %}
            {% endif %}

            <div class="movie-content">
                <div class="movie-title">{{ movie.title }}</div>
                <div class="movie-info">ğŸ•’ {{ movie.showtime }}</div>
                <div class="movie-info">ğŸŸ å‰©é¤˜ {{ movie.remaining_seats }} ä½</div>

                {% if session.username %}
                    {% if movie.remaining_seats > 0 %}
                        <form method="get" action="/book/{{ movie.id }}" class="inline">
                            <button class="book-btn">è¨‚ç¥¨</button>
                        </form>
                    {% else %}
                        <button class="book-btn" disabled>å·²å”®å®Œ</button>
                    {% endif %}
                {% else %}
                    <div class="disabled">è«‹å…ˆç™»å…¥</div>
                {% endif %}

                {% if session.employee_id %}
                    <form method="post" action="/delete_movie/{{ movie.id }}" class="inline"
                          onsubmit="return confirm('ç¢ºå®šåˆªé™¤é€™éƒ¨é›»å½±å—ï¼Ÿ');">
                        <button class="delete-btn">åˆªé™¤</button>
                    </form>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
</div>

</body>
</html>