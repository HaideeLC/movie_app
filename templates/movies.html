<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>é›»å½±åˆ—è¡¨</title>
    <!-- CSS å¼•ç”¨ -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        table { border-collapse: collapse; width: 100%; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
        img.movie-poster { width: 100px; height: 150px; object-fit: cover; border-radius: 4px; border: 1px solid #ccc; }
        button.book-btn, button.delete-btn, button.add-btn { 
            padding: 4px 8px; border: none; border-radius: 4px; color: white; cursor: pointer; 
        }
        button.book-btn { background-color: green; }
        button.delete-btn { background-color: red; }
        button.add-btn { background-color: blue; margin-top: 10px; }
        span.disabled { color: gray; }
        a { text-decoration: none; }
        hr { margin: 20px 0; }
        form.inline { display: inline; } /* è®“åˆªé™¤æŒ‰éˆ•åœ¨åŒä¸€è¡Œ */
    </style>
</head>
<body>

<!-- å°è¦½åˆ— -->
{% if session.username %}
<p>
    ä½ å¥½ï¼Œ{{ session.username }} | 
    <a href="/logout">ç™»å‡º</a> | 
    <a href="/order">ğŸ“„ æŸ¥è©¢è¨‚å–®</a>
</p>
{% else %}
<p>
    <a href="/login">ç™»å…¥</a> | 
    <a href="/register">è¨»å†Š</a> | 
    <a href="/order">ğŸ“„ æŸ¥è©¢è¨‚å–®</a> | 
    <a href="/employee_login">å“¡å·¥ç™»å…¥</a>
</p>
{% endif %}

<hr>

<h1>é›»å½±åˆ—è¡¨</h1>

{% if session.employee_id %}
<h2>æ–°å¢é›»å½±</h2>
<form method="post" action="/manage_movies">
    é›»å½±åç¨±ï¼š<input type="text" name="title" required>
    æ”¾æ˜ æ™‚é–“ï¼š<input type="text" name="showtime" required>
    ç¸®åœ–æª”åï¼ˆæ”¾åœ¨ static/posters/ï¼‰ï¼š<input type="text" name="poster_url">
    <button type="submit" class="add-btn">æ–°å¢</button>
</form>
{% endif %}

<table>
    <thead>
        <tr>
            <th>é›»å½±åç¨±</th>
            <th>é›»å½±ç¸®åœ–</th>
            <th>æ”¾æ˜ æ™‚é–“</th>
            <th>åº§ä½å‰©é¤˜æ•¸</th>
            <th>è³¼</th>
        </tr>
    </thead>
    <tbody>
        {% for movie in movies %}
        <tr>
            <td>{{ movie.title }}</td>
            <td>
                {% if movie.poster_url %}
                    <img class="movie-poster" src="{{ url_for('static', filename=movie.poster_url) }}" alt="{{ movie.title }}">
                {% else %}
                    <img class="movie-poster" src="https://via.placeholder.com/100x150?text=No+Image" alt="No Image">
                {% endif %}
            </td>
            <td>{{ movie.showtime }}</td>
            <td>{{ movie.remaining_seats }}</td> 
            <td>
                {% if session.username %}
                    <form method="get" action="/book/{{ movie.id }}" class="inline">
                        <button type="submit" class="book-btn">è¨‚ç¥¨</button>
                    </form>
                {% else %}
                    <span class="disabled">è«‹å…ˆç™»å…¥</span>
                {% endif %}

                {% if session.employee_id %}
                    <form method="post" action="/delete_movie/{{ movie.id }}" class="inline" onsubmit="return confirm('ç¢ºå®šåˆªé™¤é€™éƒ¨é›»å½±å—ï¼Ÿ');">
                        <button type="submit" class="delete-btn">åˆªé™¤</button>
                    </form>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

</body>
</html>